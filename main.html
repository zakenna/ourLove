<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>FullCalendar 날짜 정확히 추가</title>
    <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>
    <style>
        /* 입력창 스타일 약간 개선 */
        .fc-daygrid-day-frame input {
            position: absolute;
            top: 25%;
            left: 5%;
            width: 50%;
            height: 40%;
            font-size: 12px;
            z-index: 10;
        }
    </style>
</head>
<body>
    <div id="Calendar"></div>
    <script>
    document.addEventListener('DOMContentLoaded', function () {
        const calendarEl = document.getElementById('Calendar');
        const calendar = new FullCalendar.Calendar(calendarEl, {
            initialView: 'dayGridMonth',
            timeZone: 'local', // 시간대를 로컬로 맞춰줍니다!
            events: [
                { title: "회의", start: "2025-05-27", allDay: true }
            ],
            dayCellDidMount: function(info) {
                info.el.addEventListener('dblclick', function(e) {
                    if (info.el.querySelector('input')) return;
                    const input = document.createElement('input');
                    input.type = 'text';
                    input.placeholder = '일정 입력 후 엔터';
                    input.style.width = '90%';
                    input.style.fontSize = '12px';
                    // 스타일을 위해 position: relative
                    info.el.style.position = 'relative';
                    info.el.appendChild(input);
                    input.focus();
                    input.addEventListener('keydown', function(event) {
                        if (event.key === 'Enter' && input.value.trim() !== '') {
                            // 날짜를 로컬 날짜 문자열로 변환
                            const localDateStr = info.date.toISOString().split('T')[0];
                            calendar.addEvent({
                                title: input.value,
                                start: localDateStr,
                                allDay: true
                            });
                            input.remove();
                        }
                        if (event.key === 'Escape') {
                            input.remove();
                        }
                    });
                    input.addEventListener('blur', function() {
                        setTimeout(() => {
                            if (input.parentNode) input.remove();
                        }, 10);
                    });
                });
            }
        });
        calendar.render();
    });
    </script>
</body>
</html>
